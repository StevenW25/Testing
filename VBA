Sub LaunchEdgeAndSearchGoogle()
    Dim url As String
    Dim searchQuery As String
    Dim script As String
    Dim shell As Object
    
    ' URL to navigate to (Google)
    url = "https://www.google.com"
    
    ' Search query
    searchQuery = "Best Buy"
    
    ' PowerShell script to launch Edge, navigate to the URL, and perform search
    script = "Start-Process 'msedge.exe' '" & url & "'; " & _
             "Start-Sleep -Seconds 3; " & _
             "$wshell = New-Object -ComObject wscript.shell; " & _
             "Start-Sleep -Seconds 5; " & _
             "$wshell.SendKeys('^l'); " & _
             "Start-Sleep -Seconds 5; " & _
             "$wshell.SendKeys('^a'); " & _
            "Start-Sleep -Seconds 5; " & _
             "$wshell.SendKeys(''); " & _
            "Start-Sleep -Seconds 5; " & _
             "$wshell.SendKeys('" & url & "'); " & _
            "Start-Sleep -Seconds 5; " & _
             "$wshell.SendKeys('{ENTER}'); " & _
            "Start-Sleep -Seconds 2; " & _
             "$wshell.SendKeys('" & searchQuery & "'); " & _
             "$wshell.SendKeys('{ENTER}');"
    
    ' Create Shell object to run the PowerShell script
    Set shell = CreateObject("WScript.Shell")
    
    ' Run the PowerShell script
    shell.Run "powershell -Command " & Chr(34) & script & Chr(34), 1, True
    
    ' Clean up
    Set shell = Nothing
End Sub

javascript:(function() {
    var luckyButton = document.querySelector("[name='btnI']");
    if (luckyButton) {
        luckyButton.click();
    } else {
        alert("The 'I'm Feeling Lucky' button is not available on this page.");
    }
})();



# URL where the bookmarklet is used
$baseURL = "https://www.google.ca"

# JavaScript code for the bookmarklet (encoded as a URL)
$bookmarklet = "javascript:(function() { var luckyButton = document.querySelector('[name=btnI]'); if (luckyButton) { luckyButton.click(); } else { alert('The I''m Feeling Lucky button is not available on this page.'); } })();"

# Combine the base URL and bookmarklet
$fullURL = "$baseURL/$bookmarklet"

# Open Edge with the full URL
Start-Process "msedge.exe" $fullURL


# Path to Microsoft Edge executable (adjust as needed)
$edgePath = "C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe"

# Launch Edge with remote debugging on port 9222
Start-Process $edgePath -ArgumentList "--remote-debugging-port=9222"


<!DOCTYPE html>
<html lang="en">
<head>
    <title>Auto Bookmarklet</title>
    <script>
        window.onload = function() {
            // Open the desired website
            window.location.href = "https://example.com";

            // Wait for the website to load and execute the bookmarklet code
            setTimeout(function() {
                // Your bookmarklet code here
                alert("Bookmarklet running!");
            }, 3000); // Adjust the delay as needed
        };
    </script>
</head>
<body>
    <p>Redirecting to the website...</p>
</body>
</html>



<!DOCTYPE html>
<html lang="en">
<head>
    <title>Auto-Run JavaScript</title>
    <script>
        // Automatically load the website and inject JavaScript
        window.onload = function() {
            // Open the desired website
            const targetURL = "https://example.com"; // Replace with the target URL
            const jsCode = `
                // Your bookmarklet code here
                alert('JavaScript running!');
                document.body.style.border = '5px solid green';
            `;

            // Open the website in an iframe
            const iframe = document.createElement('iframe');
            iframe.src = targetURL;
            iframe.style = "width: 100%; height: 100vh; border: none;";
            document.body.appendChild(iframe);

            // Wait for the iframe to load and inject the script
            iframe.onload = function() {
                const script = iframe.contentDocument.createElement('script');
                script.textContent = jsCode;
                iframe.contentDocument.body.appendChild(script);
            };
        };
    </script>
</head>
<body>
    <p>Loading the website...</p>
</body>
</html>

